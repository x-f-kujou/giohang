<form id="orderForm" action="https://docs.google.com/forms/d/19Xt8NNu1OuJod_dj4NN4uQlwVpoXcvTxrCx-T_01uRo/formResponse" method="POST" target="_self">
  <!-- Ô nhập dữ liệu hiển thị cho người dùng -->
  <label>Tên khách hàng:
    <input type="text" id="customerName" name="entry.7182938401" required>
  </label><br>
  <label>Số điện thoại:
    <input type="text" id="phoneNumber" name="entry.9371826540" required>
  </label><br>
  <!-- Ô ẩn để chứa dữ liệu sản phẩm và tổng tiền -->
  <input type="hidden" id="productList" name="entry.4123789056">
  <input type="hidden" id="totalAmount" name="entry.6685492037">
  <button type="submit">Gửi đơn hàng</button>
</form>

<script>
// Giả sử giỏ hàng lưu trong localStorage dưới key 'cart' (dạng JSON string)
let cart = JSON.parse(localStorage.getItem("cart") || "[]");

// Tạo chuỗi danh sách sản phẩm và tính tổng
let productNames = [];
let total = 0;
cart.forEach(item => {
  productNames.push(item.name + " (x" + item.quantity + ")");
  total += item.price * item.quantity;
});

// Điền dữ liệu vào form trước khi submit
document.getElementById("productList").value = productNames.join(", ");
document.getElementById("totalAmount").value = total;
</script>
  cart[i].qty += d;
  if (cart[i].qty <= 0) cart.splice(i, 1);
  saveCart(cart);
}

function removeItem(i) {
  const cart = getCart();
  cart.splice(i, 1);
  saveCart(cart);
}

renderCart();

document.getElementById("submit").onclick = () => {
  const order = {
    name: name.value,
    phone: phone.value,
    items: getCart(),
    time: new Date().toLocaleString("vi-VN")
  };

  fetch(SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(order)
  });

  localStorage.removeItem("cart");

  setTimeout(() => {
    window.location.href = "thankyou.html";
  }, 800);
};
</script>

</body>
</html>
