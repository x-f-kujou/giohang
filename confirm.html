<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>X√°c nh·∫≠n thanh to√°n</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<h2>üí≥ Thanh to√°n chuy·ªÉn kho·∫£n</h2>

<div class="product-detail">

<p><b>Ng√¢n h√†ng:</b> Vietcombank</p>
<p><b>S·ªë TK:</b> 1027122144</p>
<p><b>Ch·ªß TK:</b> TU TU PHUONG</p>
<p><b>N·ªôi dung CK:</b> T√™n + SƒêT</p>

<hr>

<h3>üì¶ Th√¥ng tin ƒë∆°n h√†ng</h3>

<div id="orderInfo"></div>

<br>

<button onclick="submitOrder()">‚úÖ T√¥i ƒë√£ chuy·ªÉn kho·∫£n</button>

</div>

<script>
const FORM_URL =
"https://docs.google.com/forms/d/e/1FAIpQLSc8Ts9qc4T-TRYX7my_6ryTBAis3bEU-yhrONjsZss1s15rIg/formResponse";

/* ===== ENTRY ID ‚Äì ƒê·ªîI THEO FORM C·ª¶A B·∫†N ===== */
const ENTRY = {
  name: "entry.1313927642",
  phone: "entry.1798347891",
  address: "entry.428704529",
  products: "entry.131920185",
  total: "entry.1824592539",
  note: "entry.1497400442"
};

/* ===== L·∫§Y GI·ªé ===== */
const cart = JSON.parse(localStorage.getItem("cart") || "[]");

let productText = "";
let total = 0;

cart.forEach(p => {
  productText += `${p.name} (x${p.qty})\n`;
  total += p.price * p.qty;
});

document.getElementById("orderInfo").innerHTML = `
<p><b>S·∫£n ph·∫©m:</b><br>${productText.replace(/\n/g,"<br>")}</p>
<p><b>T·ªïng ti·ªÅn:</b> ${total.toLocaleString("vi-VN")} ‚Ç´</p>
`;

/* ===== SUBMIT FORM ===== */
function submitOrder() {

  const name = localStorage.getItem("customer_name") || "";
  const phone = localStorage.getItem("customer_phone") || "";
  const address = localStorage.getItem("customer_address") || "";

  const formData = new FormData();
  formData.append(ENTRY.name, name);
  formData.append(ENTRY.phone, phone);
  formData.append(ENTRY.address, address);
  formData.append(ENTRY.products, productText);
  formData.append(ENTRY.total, total);
  formData.append(ENTRY.note, "Kh√°ch ƒë√£ chuy·ªÉn kho·∫£n");

  fetch(FORM_URL, {
    method: "POST",
    mode: "no-cors",
    body: formData
  });

  localStorage.removeItem("cart");

  alert("‚úÖ ƒê√£ g·ª≠i x√°c nh·∫≠n! Shop s·∫Ω li√™n h·ªá s·ªõm.");

  window.location.href = "thankyou.html";
}
</script>

</body>
</html>
